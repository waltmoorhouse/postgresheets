import{S as Ee,i as ye,s as we,x as qe,V as Ce,d as m,y as ie,z as ce,A as Te,B as De,C as Me,W as Ne,c as U,l as x,g as b,h as M,o as g,X as Pe,Y as Ke,J as Oe,b as ve,e as p,Z as le,k as ee,j as N,t as te,p as P,f as y,_ as We,D as pe,r as Se,U as Ue,E as me,K as H,F as he,m as ue,G as _e,u as ze}from"../chunks/index.js";/* empty css           */function Ge(s,t){const e={},u={},o={$$scope:1};let C=s.length;for(;C--;){const i=s[C],c=t[C];if(c){for(const l in i)l in c||(u[l]=1);for(const l in c)o[l]||(e[l]=c[l],o[l]=1);s[C]=c}else for(const l in i)o[l]=1}for(const i in u)i in e||(e[i]=void 0);return e}function Xe(s){let t,e,u,o,C;const i=s[5].default,c=qe(i,s,s[4],null);let l=[{class:e=`ps-btn ${s[0]==="primary"?"ps-btn--primary":""} ${s[0]==="accent"?"ps-btn--accent":""} ${s[0]==="ghost"?"ps-btn--ghost":""} ${s[0]==="link"?"ps-btn--link":""}`},{type:s[2]},{disabled:s[1]},s[3]],f={};for(let n=0;n<l.length;n+=1)f=Ce(f,l[n]);return{c(){t=g("button"),c&&c.c(),this.h()},l(n){t=b(n,"BUTTON",{class:!0,type:!0});var r=M(t);c&&c.l(r),r.forEach(m),this.h()},h(){Ne(t,f)},m(n,r){U(n,t,r),c&&c.m(t,null),t.autofocus&&t.focus(),u=!0,o||(C=x(t,"click",s[6]),o=!0)},p(n,[r]){c&&c.p&&(!u||r&16)&&Te(c,i,n,n[4],u?Me(i,n[4],r,null):De(n[4]),null),Ne(t,f=Ge(l,[(!u||r&1&&e!==(e=`ps-btn ${n[0]==="primary"?"ps-btn--primary":""} ${n[0]==="accent"?"ps-btn--accent":""} ${n[0]==="ghost"?"ps-btn--ghost":""} ${n[0]==="link"?"ps-btn--link":""}`))&&{class:e},(!u||r&4)&&{type:n[2]},(!u||r&2)&&{disabled:n[1]},r&8&&n[3]]))},i(n){u||(ce(c,n),u=!0)},o(n){ie(c,n),u=!1},d(n){n&&m(t),c&&c.d(n),o=!1,C()}}}function Je(s,t,e){const u=["variant","disabled","type"];let o=Pe(t,u),{$$slots:C={},$$scope:i}=t,{variant:c="default"}=t,{disabled:l=!1}=t,{type:f="button"}=t;function n(r){Oe.call(this,s,r)}return s.$$set=r=>{t=Ce(Ce({},t),Ke(r)),e(3,o=Pe(t,u)),"variant"in r&&e(0,c=r.variant),"disabled"in r&&e(1,l=r.disabled),"type"in r&&e(2,f=r.type),"$$scope"in r&&e(4,i=r.$$scope)},[c,l,f,o,i,C,n]}class ge extends Ee{constructor(t){super(),ye(this,t,Je,Xe,we,{variant:0,disabled:1,type:2})}}function Ae(s){let t,e;return{c(){t=g("div"),e=te(s[1]),this.h()},l(u){t=b(u,"DIV",{class:!0,style:!0});var o=M(t);e=ee(o,s[1]),o.forEach(m),this.h()},h(){y(t,"class","muted"),le(t,"font-size","0.85em")},m(u,o){U(u,t,o),p(t,e)},p(u,o){o&2&&ve(e,u[1])},d(u){u&&m(t)}}}function Ye(s){let t,e,u,o,C,i;const c=s[3].default,l=qe(c,s,s[2],null);let f=s[1]&&Ae(s);return{c(){t=g("label"),e=g("div"),u=te(s[0]),o=P(),l&&l.c(),C=P(),f&&f.c(),this.h()},l(n){t=b(n,"LABEL",{});var r=M(t);e=b(r,"DIV",{style:!0});var d=M(e);u=ee(d,s[0]),d.forEach(m),o=N(r),l&&l.l(r),C=N(r),f&&f.l(r),r.forEach(m),this.h()},h(){le(e,"font-weight","600")},m(n,r){U(n,t,r),p(t,e),p(e,u),p(t,o),l&&l.m(t,null),p(t,C),f&&f.m(t,null),i=!0},p(n,[r]){(!i||r&1)&&ve(u,n[0]),l&&l.p&&(!i||r&4)&&Te(l,c,n,n[2],i?Me(c,n[2],r,null):De(n[2]),null),n[1]?f?f.p(n,r):(f=Ae(n),f.c(),f.m(t,null)):f&&(f.d(1),f=null)},i(n){i||(ce(l,n),i=!0)},o(n){ie(l,n),i=!1},d(n){n&&m(t),l&&l.d(n),f&&f.d()}}}function Ze(s,t,e){let{$$slots:u={},$$scope:o}=t,{label:C=""}=t,{hint:i=null}=t;return s.$$set=c=>{"label"in c&&e(0,C=c.label),"hint"in c&&e(1,i=c.hint),"$$scope"in c&&e(2,o=c.$$scope)},[C,i,o,u]}class Qe extends Ee{constructor(t){super(),ye(this,t,Ze,Ye,we,{label:0,hint:1})}}function xe(s){let t,e,u;return{c(){t=g("input"),this.h()},l(o){t=b(o,"INPUT",{id:!0,placeholder:!0}),this.h()},h(){y(t,"id","name"),y(t,"placeholder","My Database")},m(o,C){U(o,t,C),H(t,s[0]),e||(u=x(t,"input",s[24]),e=!0)},p(o,C){C[0]&1&&t.value!==o[0]&&H(t,o[0])},d(o){o&&m(t),e=!1,u()}}}function $e(s){let t,e="Host",u,o,C,i,c,l,f="Port",n,r,d,w,S,z="Database",K,v,I,L,A,V,T="Username",G,O,Z,X,q,J="Password",se,D,$,B,j,ne,oe,ae;return{c(){t=g("label"),t.textContent=e,u=P(),o=g("input"),C=P(),i=g("div"),c=g("div"),l=g("label"),l.textContent=f,n=P(),r=g("input"),d=P(),w=g("div"),S=g("label"),S.textContent=z,K=P(),v=g("input"),I=P(),L=g("div"),A=g("div"),V=g("label"),V.textContent=T,G=P(),O=g("input"),Z=P(),X=g("div"),q=g("label"),q.textContent=J,se=P(),D=g("input"),$=P(),B=g("label"),j=g("input"),ne=te(" SSL"),this.h()},l(E){t=b(E,"LABEL",{for:!0,"data-svelte-h":!0}),ue(t)!=="svelte-sunxie"&&(t.textContent=e),u=N(E),o=b(E,"INPUT",{id:!0,placeholder:!0}),C=N(E),i=b(E,"DIV",{class:!0});var k=M(i);c=b(k,"DIV",{style:!0});var R=M(c);l=b(R,"LABEL",{for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-1qb0aiy"&&(l.textContent=f),n=N(R),r=b(R,"INPUT",{id:!0}),R.forEach(m),d=N(k),w=b(k,"DIV",{style:!0});var h=M(w);S=b(h,"LABEL",{for:!0,"data-svelte-h":!0}),ue(S)!=="svelte-pcqnfi"&&(S.textContent=z),K=N(h),v=b(h,"INPUT",{id:!0,placeholder:!0}),h.forEach(m),k.forEach(m),I=N(E),L=b(E,"DIV",{class:!0});var _=M(L);A=b(_,"DIV",{style:!0});var Q=M(A);V=b(Q,"LABEL",{for:!0,"data-svelte-h":!0}),ue(V)!=="svelte-1wr0xay"&&(V.textContent=T),G=N(Q),O=b(Q,"INPUT",{id:!0}),Q.forEach(m),Z=N(_),X=b(_,"DIV",{style:!0});var W=M(X);q=b(W,"LABEL",{for:!0,"data-svelte-h":!0}),ue(q)!=="svelte-19vcb14"&&(q.textContent=J),se=N(W),D=b(W,"INPUT",{id:!0,type:!0}),W.forEach(m),_.forEach(m),$=N(E),B=b(E,"LABEL",{});var a=M(B);j=b(a,"INPUT",{type:!0}),ne=ee(a," SSL"),a.forEach(m),this.h()},h(){y(t,"for","host"),y(o,"id","host"),y(o,"placeholder","localhost"),y(l,"for","port"),y(r,"id","port"),le(c,"flex","1"),y(S,"for","database"),y(v,"id","database"),y(v,"placeholder","postgres"),le(w,"flex","1"),y(i,"class","row svelte-d7xtyc"),y(V,"for","username"),y(O,"id","username"),le(A,"flex","1"),y(q,"for","passwordManual"),y(D,"id","passwordManual"),y(D,"type","password"),le(X,"flex","1"),y(L,"class","row svelte-d7xtyc"),y(j,"type","checkbox")},m(E,k){U(E,t,k),U(E,u,k),U(E,o,k),H(o,s[4]),U(E,C,k),U(E,i,k),p(i,c),p(c,l),p(c,n),p(c,r),H(r,s[5]),p(i,d),p(i,w),p(w,S),p(w,K),p(w,v),H(v,s[6]),U(E,I,k),U(E,L,k),p(L,A),p(A,V),p(A,G),p(A,O),H(O,s[7]),p(L,Z),p(L,X),p(X,q),p(X,se),p(X,D),H(D,s[8]),U(E,$,k),U(E,B,k),p(B,j),j.checked=s[10],p(B,ne),oe||(ae=[x(o,"input",s[30]),x(r,"input",s[31]),x(v,"input",s[32]),x(O,"input",s[33]),x(D,"input",s[34]),x(j,"change",s[35])],oe=!0)},p(E,k){k[0]&16&&o.value!==E[4]&&H(o,E[4]),k[0]&32&&r.value!==E[5]&&H(r,E[5]),k[0]&64&&v.value!==E[6]&&H(v,E[6]),k[0]&128&&O.value!==E[7]&&H(O,E[7]),k[0]&256&&D.value!==E[8]&&H(D,E[8]),k[0]&1024&&(j.checked=E[10])},d(E){E&&(m(t),m(u),m(o),m(C),m(i),m(I),m(L),m($),m(B)),oe=!1,Se(ae)}}}function et(s){let t,e="Connection string",u,o,C,i,c="Password (connection string mode)",l,f,n,r;return{c(){t=g("label"),t.textContent=e,u=P(),o=g("textarea"),C=P(),i=g("label"),i.textContent=c,l=P(),f=g("input"),this.h()},l(d){t=b(d,"LABEL",{for:!0,"data-svelte-h":!0}),ue(t)!=="svelte-14rvt5g"&&(t.textContent=e),u=N(d),o=b(d,"TEXTAREA",{id:!0,rows:!0,placeholder:!0}),M(o).forEach(m),C=N(d),i=b(d,"LABEL",{for:!0,"data-svelte-h":!0}),ue(i)!=="svelte-1cflhfn"&&(i.textContent=c),l=N(d),f=b(d,"INPUT",{id:!0,type:!0}),this.h()},h(){y(t,"for","connStr"),y(o,"id","connStr"),y(o,"rows",3),y(o,"placeholder","postgres://user:password@host:5432/db?sslmode=require"),y(i,"for","password"),y(f,"id","password"),y(f,"type","password")},m(d,w){U(d,t,w),U(d,u,w),U(d,o,w),H(o,s[2]),U(d,C,w),U(d,i,w),U(d,l,w),U(d,f,w),H(f,s[3]),n||(r=[x(o,"input",s[28]),x(f,"input",s[29])],n=!0)},p(d,w){w[0]&4&&H(o,d[2]),w[0]&8&&f.value!==d[3]&&H(f,d[3])},d(d){d&&(m(t),m(u),m(o),m(C),m(i),m(l),m(f)),n=!1,Se(r)}}}function tt(s){let t;return{c(){t=te("Test Connection")},l(e){t=ee(e,"Test Connection")},m(e,u){U(e,t,u)},d(e){e&&m(t)}}}function st(s){let t;return{c(){t=te("Save")},l(e){t=ee(e,"Save")},m(e,u){U(e,t,u)},d(e){e&&m(t)}}}function nt(s){let t;return{c(){t=te("Cancel")},l(e){t=ee(e,"Cancel")},m(e,u){U(e,t,u)},d(e){e&&m(t)}}}function ot(s){let t,e,u=s[14]?"Edit Connection":"Add Connection",o,C,i,c,l,f,n="Entry Mode",r,d,w,S,z,K,v,I,L,A,V,T,G,O,Z,X,q,J,se,D,$,B,j,ne,oe,ae;i=new Qe({props:{label:"Name",hint:"A friendly name for this connection",$$slots:{default:[xe]},$$scope:{ctx:s}}});function E(h,_){return h[1]==="connectionString"?et:$e}let k=E(s),R=k(s);return J=new ge({props:{variant:"ghost",disabled:!s[9],$$slots:{default:[tt]},$$scope:{ctx:s}}}),J.$on("click",s[15]),D=new ge({props:{variant:"primary",disabled:!s[13],$$slots:{default:[st]},$$scope:{ctx:s}}}),D.$on("click",s[16]),B=new ge({props:{variant:"link",$$slots:{default:[nt]},$$scope:{ctx:s}}}),B.$on("click",s[17]),ne=We(s[26][0]),{c(){t=g("div"),e=g("h2"),o=te(u),C=P(),_e(i.$$.fragment),c=P(),l=g("fieldset"),f=g("legend"),f.textContent=n,r=P(),d=g("div"),w=g("label"),S=g("input"),z=te(" Connection string"),K=P(),v=g("label"),I=g("input"),L=te(" Manual fields"),A=P(),R.c(),V=P(),T=g("div"),G=g("span"),O=te(s[11]),X=P(),q=g("div"),_e(J.$$.fragment),se=P(),_e(D.$$.fragment),$=P(),_e(B.$$.fragment),this.h()},l(h){t=b(h,"DIV",{});var _=M(t);e=b(_,"H2",{});var Q=M(e);o=ee(Q,u),Q.forEach(m),C=N(_),he(i.$$.fragment,_),c=N(_),l=b(_,"FIELDSET",{});var W=M(l);f=b(W,"LEGEND",{"data-svelte-h":!0}),ue(f)!=="svelte-1l8tsjr"&&(f.textContent=n),r=N(W),d=b(W,"DIV",{class:!0});var a=M(d);w=b(a,"LABEL",{for:!0});var F=M(w);S=b(F,"INPUT",{id:!0,type:!0}),z=ee(F," Connection string"),F.forEach(m),K=N(a),v=b(a,"LABEL",{for:!0});var Y=M(v);I=b(Y,"INPUT",{id:!0,type:!0}),L=ee(Y," Manual fields"),Y.forEach(m),a.forEach(m),W.forEach(m),A=N(_),R.l(_),V=N(_),T=b(_,"DIV",{class:!0});var fe=M(T);G=b(fe,"SPAN",{class:!0});var de=M(G);O=ee(de,s[11]),de.forEach(m),fe.forEach(m),X=N(_),q=b(_,"DIV",{style:!0});var re=M(q);he(J.$$.fragment,re),se=N(re),he(D.$$.fragment,re),$=N(re),he(B.$$.fragment,re),re.forEach(m),_.forEach(m),this.h()},h(){y(S,"id","mode-connection"),y(S,"type","radio"),S.__value="connectionString",H(S,S.__value),y(w,"for","mode-connection"),y(I,"id","mode-manual"),y(I,"type","radio"),I.__value="manual",H(I,I.__value),y(v,"for","mode-manual"),y(d,"class","row svelte-d7xtyc"),y(G,"class",Z=Ue(s[12]==="error"?"error":s[12]==="success"?"success":"muted")+" svelte-d7xtyc"),y(T,"class","status svelte-d7xtyc"),le(q,"margin-top","12px"),le(q,"display","flex"),le(q,"gap","8px"),ne.p(S,I)},m(h,_){U(h,t,_),p(t,e),p(e,o),p(t,C),me(i,t,null),p(t,c),p(t,l),p(l,f),p(l,r),p(l,d),p(d,w),p(w,S),S.checked=S.__value===s[1],p(w,z),p(d,K),p(d,v),p(v,I),I.checked=I.__value===s[1],p(v,L),p(t,A),R.m(t,null),p(t,V),p(t,T),p(T,G),p(G,O),p(t,X),p(t,q),me(J,q,null),p(q,se),me(D,q,null),p(q,$),me(B,q,null),j=!0,oe||(ae=[x(S,"change",s[25]),x(I,"change",s[27])],oe=!0)},p(h,_){const Q={};_[0]&1|_[1]&2048&&(Q.$$scope={dirty:_,ctx:h}),i.$set(Q),_[0]&2&&(S.checked=S.__value===h[1]),_[0]&2&&(I.checked=I.__value===h[1]),k===(k=E(h))&&R?R.p(h,_):(R.d(1),R=k(h),R&&(R.c(),R.m(t,V))),(!j||_[0]&2048)&&ve(O,h[11]),(!j||_[0]&4096&&Z!==(Z=Ue(h[12]==="error"?"error":h[12]==="success"?"success":"muted")+" svelte-d7xtyc"))&&y(G,"class",Z);const W={};_[0]&512&&(W.disabled=!h[9]),_[1]&2048&&(W.$$scope={dirty:_,ctx:h}),J.$set(W);const a={};_[0]&8192&&(a.disabled=!h[13]),_[1]&2048&&(a.$$scope={dirty:_,ctx:h}),D.$set(a);const F={};_[1]&2048&&(F.$$scope={dirty:_,ctx:h}),B.$set(F)},i(h){j||(ce(i.$$.fragment,h),ce(J.$$.fragment,h),ce(D.$$.fragment,h),ce(B.$$.fragment,h),j=!0)},o(h){ie(i.$$.fragment,h),ie(J.$$.fragment,h),ie(D.$$.fragment,h),ie(B.$$.fragment,h),j=!1},d(h){h&&m(t),pe(i),R.d(),pe(J),pe(D),pe(B),ne.r(),oe=!1,Se(ae)}}}function rt(s){const t=s.trim();if(!t)return null;try{const e=new URL(t),u=e.pathname.replace(/^\//,"");return{host:e.hostname,port:e.port||"5432",database:decodeURIComponent(u),username:decodeURIComponent(e.username||""),password:decodeURIComponent(e.password||""),ssl:e.searchParams.get("sslmode")==="require"}}catch{return null}}function lt(s,t,e){let u,o,C,i,{vscode:c}=t,{initialState:l={}}=t,f=l.name||"",n=l.mode||"connectionString",r="",d=l.password||"",w=l.host||"",S=l.port?String(l.port):"5432",z=l.database||"",K=l.username||"",v=l.password||"",I=l.ssl||!1,L="",A="",V=!1,T=n,G=l.editMode||!1,O=l.id||void 0;function Z(){if(!c)throw new Error("VS Code API unavailable");return c}function X(){var Ie,Le;const a=w.trim(),F=S.trim(),Y=z.trim(),fe=K.trim();if(!a)return null;const de=/^postgresql?:\/\//i.test(r)?((Le=(Ie=r.match(/^postgresql?:\/\//i))==null?void 0:Ie[0])==null?void 0:Le.toLowerCase())??"postgresql://":"postgresql://",re=fe?encodeURIComponent(fe):"",Ve=v?`:${encodeURIComponent(v)}`:"",Be=re?`${re}${Ve}@`:"",be=Number(F),Re=!Number.isNaN(be)&&be>0?`:${be}`:"",Fe=a.includes(":")&&!a.startsWith("[")&&!a.endsWith("]")?`[${a}]`:a,He=Y?`/${encodeURIComponent(Y)}`:"",je=I?"?sslmode=require":"";return`${de.replace(/\/\/$/,"")}//${Be}${Fe}${Re}${He}${je}`}function q(){return n==="connectionString"?{mode:"connectionString",connStr:r,password:d}:{mode:"manual",host:w,port:S,database:z,username:K,password:v,ssl:I}}async function J(){e(11,L="Testing..."),e(12,A="info"),e(20,V=!0);try{Z().postMessage({command:"testConnection",payload:q()})}catch(a){e(11,L=String(a)),e(12,A="error")}}async function se(){e(11,L="Saving..."),e(12,A="info"),e(20,V=!0);try{const a=q(),F=f.trim();if(!F){e(11,L="Name is required to save"),e(12,A="error"),e(20,V=!1);return}a.name=F,a.editMode=G,a.id=O,Z().postMessage({command:"saveConnection",payload:a})}catch(a){e(11,L=String(a)),e(12,A="error")}}function D(){try{Z().postMessage({command:"cancel"})}catch{}}function $(a){const F=a.data;if(!(!F||typeof F!="object")){if(F.command==="testResult"){const Y=F.payload;Y.success?(e(11,L="Connection OK"),e(12,A="success")):(e(11,L="Failed: "+(Y.error||"Unknown error")),e(12,A="error")),e(20,V=!1)}else if(F.command==="saveResult"){const Y=F.payload;Y.success?(e(11,L="Saved"),e(12,A="success")):(e(11,L="Save failed: "+(Y.error||"Unknown error")),e(12,A="error")),e(20,V=!1)}}}ze(()=>(window.addEventListener("message",$),()=>window.removeEventListener("message",$)));const B=[[]];function j(){f=this.value,e(0,f)}function ne(){n=this.__value,e(1,n)}function oe(){n=this.__value,e(1,n)}function ae(){r=this.value,e(2,r),e(1,n),e(21,T),e(3,d),e(8,v)}function E(){d=this.value,e(3,d),e(1,n),e(21,T),e(2,r),e(8,v)}function k(){w=this.value,e(4,w),e(1,n),e(21,T),e(2,r),e(3,d),e(8,v)}function R(){S=this.value,e(5,S),e(1,n),e(21,T),e(2,r),e(3,d),e(8,v)}function h(){z=this.value,e(6,z),e(1,n),e(21,T),e(2,r),e(3,d),e(8,v)}function _(){K=this.value,e(7,K),e(1,n),e(21,T),e(2,r),e(3,d),e(8,v)}function Q(){v=this.value,e(8,v),e(1,n),e(21,T),e(2,r),e(3,d)}function W(){I=this.checked,e(10,I),e(1,n),e(21,T),e(2,r),e(3,d),e(8,v)}return s.$$set=a=>{"vscode"in a&&e(18,c=a.vscode),"initialState"in a&&e(19,l=a.initialState)},s.$$.update=()=>{if(s.$$.dirty[0]&1&&f.trim().length,s.$$.dirty[0]&2097422&&n!==T){if(n==="manual"){const a=rt(r);a&&(e(4,w=a.host||""),e(5,S=a.port||"5432"),e(6,z=a.database||""),e(7,K=a.username||""),e(8,v=a.password||""),e(10,I=a.ssl),e(3,d=a.password||d))}else{const a=X();a&&e(2,r=a),e(3,d=v)}e(21,T=n)}if(s.$$.dirty[0]&6&&n==="connectionString"&&(!r||r.trim().length===0?e(23,u="Connection string is required"):/^(postgres|postgresql):\/\//i.test(r.trim())?e(23,u=""):e(23,u="Connection string should start with postgres:// or postgresql://")),s.$$.dirty[0]&242&&n==="manual"){e(22,o.host=w.trim()?"":"Host is required",o),e(22,o.database=z.trim()?"":"Database is required",o),e(22,o.username=K.trim()?"":"Username is required",o);const a=Number(S);e(22,o.port=!S||Number.isNaN(a)||a<=0||a>65535?"Port must be a number between 1 and 65535":"",o)}s.$$.dirty[0]&13631490&&e(9,C=!V&&(n==="connectionString"&&u===""||n==="manual"&&Object.values(o).every(a=>!a))),s.$$.dirty[0]&513&&e(13,i=C&&f.trim().length>0)},e(23,u=""),e(22,o={host:"",port:"",database:"",username:""}),[f,n,r,d,w,S,z,K,v,C,I,L,A,i,G,J,se,D,c,l,V,T,o,u,j,ne,B,oe,ae,E,k,R,h,_,Q,W]}class ut extends Ee{constructor(t){super(),ye(this,t,lt,ot,we,{vscode:18,initialState:19},null,[-1,-1])}}const ke=document.getElementById("app");if(!ke)throw new Error("No root");ke.innerHTML="";const at=window.acquireVsCodeApi?window.acquireVsCodeApi():void 0;new ut({target:ke,props:{vscode:at,initialState:window.initialState}});
