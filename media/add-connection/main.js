import{S as ge,i as Ce,s as ye,x as Ue,V as be,d as m,y as ue,z as ae,A as Ae,B as qe,C as Te,W as Ie,c as A,l as Y,g as y,h as V,o as E,X as Le,Y as Fe,J as He,b as Ee,e as p,Z as te,k as se,j as P,t as ne,p as U,f as v,_ as je,D as fe,r as ve,U as Ne,E as pe,K as F,m as ee,F as de,G as me,u as Ke}from"../chunks/index.js";/* empty css           */function Oe(s,t){const e={},u={},r={$$scope:1};let h=s.length;for(;h--;){const f=s[h],a=t[h];if(a){for(const i in f)i in a||(u[i]=1);for(const i in a)r[i]||(e[i]=a[i],r[i]=1);s[h]=a}else for(const i in f)r[i]=1}for(const f in u)f in e||(e[f]=void 0);return e}function We(s){let t,e,u,r,h;const f=s[5].default,a=Ue(f,s,s[4],null);let i=[{class:e=`ps-btn ${s[0]==="primary"?"ps-btn--primary":""} ${s[0]==="accent"?"ps-btn--accent":""} ${s[0]==="ghost"?"ps-btn--ghost":""} ${s[0]==="link"?"ps-btn--link":""}`},{type:s[2]},{disabled:s[1]},s[3]],l={};for(let n=0;n<i.length;n+=1)l=be(l,i[n]);return{c(){t=E("button"),a&&a.c(),this.h()},l(n){t=y(n,"BUTTON",{class:!0,type:!0});var o=V(t);a&&a.l(o),o.forEach(m),this.h()},h(){Ie(t,l)},m(n,o){A(n,t,o),a&&a.m(t,null),t.autofocus&&t.focus(),u=!0,r||(h=Y(t,"click",s[6]),r=!0)},p(n,[o]){a&&a.p&&(!u||o&16)&&Ae(a,f,n,n[4],u?Te(f,n[4],o,null):qe(n[4]),null),Ie(t,l=Oe(i,[(!u||o&1&&e!==(e=`ps-btn ${n[0]==="primary"?"ps-btn--primary":""} ${n[0]==="accent"?"ps-btn--accent":""} ${n[0]==="ghost"?"ps-btn--ghost":""} ${n[0]==="link"?"ps-btn--link":""}`))&&{class:e},(!u||o&4)&&{type:n[2]},(!u||o&2)&&{disabled:n[1]},o&8&&n[3]]))},i(n){u||(ae(a,n),u=!0)},o(n){ue(a,n),u=!1},d(n){n&&m(t),a&&a.d(n),r=!1,h()}}}function ze(s,t,e){const u=["variant","disabled","type"];let r=Le(t,u),{$$slots:h={},$$scope:f}=t,{variant:a="default"}=t,{disabled:i=!1}=t,{type:l="button"}=t;function n(o){He.call(this,s,o)}return s.$$set=o=>{t=be(be({},t),Fe(o)),e(3,r=Le(t,u)),"variant"in o&&e(0,a=o.variant),"disabled"in o&&e(1,i=o.disabled),"type"in o&&e(2,l=o.type),"$$scope"in o&&e(4,f=o.$$scope)},[a,i,l,r,f,h,n]}class _e extends ge{constructor(t){super(),Ce(this,t,ze,We,ye,{variant:0,disabled:1,type:2})}}function Pe(s){let t,e;return{c(){t=E("div"),e=ne(s[1]),this.h()},l(u){t=y(u,"DIV",{class:!0,style:!0});var r=V(t);e=se(r,s[1]),r.forEach(m),this.h()},h(){v(t,"class","muted"),te(t,"font-size","0.85em")},m(u,r){A(u,t,r),p(t,e)},p(u,r){r&2&&Ee(e,u[1])},d(u){u&&m(t)}}}function Ge(s){let t,e,u,r,h,f;const a=s[3].default,i=Ue(a,s,s[2],null);let l=s[1]&&Pe(s);return{c(){t=E("label"),e=E("div"),u=ne(s[0]),r=U(),i&&i.c(),h=U(),l&&l.c(),this.h()},l(n){t=y(n,"LABEL",{});var o=V(t);e=y(o,"DIV",{style:!0});var d=V(e);u=se(d,s[0]),d.forEach(m),r=P(o),i&&i.l(o),h=P(o),l&&l.l(o),o.forEach(m),this.h()},h(){te(e,"font-weight","600")},m(n,o){A(n,t,o),p(t,e),p(e,u),p(t,r),i&&i.m(t,null),p(t,h),l&&l.m(t,null),f=!0},p(n,[o]){(!f||o&1)&&Ee(u,n[0]),i&&i.p&&(!f||o&4)&&Ae(i,a,n,n[2],f?Te(a,n[2],o,null):qe(n[2]),null),n[1]?l?l.p(n,o):(l=Pe(n),l.c(),l.m(t,null)):l&&(l.d(1),l=null)},i(n){f||(ae(i,n),f=!0)},o(n){ue(i,n),f=!1},d(n){n&&m(t),i&&i.d(n),l&&l.d()}}}function Xe(s,t,e){let{$$slots:u={},$$scope:r}=t,{label:h=""}=t,{hint:f=null}=t;return s.$$set=a=>{"label"in a&&e(0,h=a.label),"hint"in a&&e(1,f=a.hint),"$$scope"in a&&e(2,r=a.$$scope)},[h,f,r,u]}class Je extends ge{constructor(t){super(),Ce(this,t,Xe,Ge,ye,{label:0,hint:1})}}function Ye(s){let t,e,u;return{c(){t=E("input"),this.h()},l(r){t=y(r,"INPUT",{id:!0,placeholder:!0}),this.h()},h(){v(t,"id","name"),v(t,"placeholder","My Database")},m(r,h){A(r,t,h),F(t,s[0]),e||(u=Y(t,"input",s[22]),e=!0)},p(r,h){h[0]&1&&t.value!==r[0]&&F(t,r[0])},d(r){r&&m(t),e=!1,u()}}}function Ze(s){let t,e="Host",u,r,h,f,a,i,l="Port",n,o,d,_,B,z="Database",S,k,M,N,D,I,G="Username",Z,H,Q,q,R,x="Password",O,W,j,K,X,$,oe,le;return{c(){t=E("label"),t.textContent=e,u=U(),r=E("input"),h=U(),f=E("div"),a=E("div"),i=E("label"),i.textContent=l,n=U(),o=E("input"),d=U(),_=E("div"),B=E("label"),B.textContent=z,S=U(),k=E("input"),M=U(),N=E("div"),D=E("div"),I=E("label"),I.textContent=G,Z=U(),H=E("input"),Q=U(),q=E("div"),R=E("label"),R.textContent=x,O=U(),W=E("input"),j=U(),K=E("label"),X=E("input"),$=ne(" SSL"),this.h()},l(b){t=y(b,"LABEL",{for:!0,"data-svelte-h":!0}),ee(t)!=="svelte-sunxie"&&(t.textContent=e),u=P(b),r=y(b,"INPUT",{id:!0,placeholder:!0}),h=P(b),f=y(b,"DIV",{class:!0});var w=V(f);a=y(w,"DIV",{style:!0});var g=V(a);i=y(g,"LABEL",{for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-1qb0aiy"&&(i.textContent=l),n=P(g),o=y(g,"INPUT",{id:!0}),g.forEach(m),d=P(w),_=y(w,"DIV",{style:!0});var C=V(_);B=y(C,"LABEL",{for:!0,"data-svelte-h":!0}),ee(B)!=="svelte-pcqnfi"&&(B.textContent=z),S=P(C),k=y(C,"INPUT",{id:!0,placeholder:!0}),C.forEach(m),w.forEach(m),M=P(b),N=y(b,"DIV",{class:!0});var c=V(N);D=y(c,"DIV",{style:!0});var L=V(D);I=y(L,"LABEL",{for:!0,"data-svelte-h":!0}),ee(I)!=="svelte-1wr0xay"&&(I.textContent=G),Z=P(L),H=y(L,"INPUT",{id:!0}),L.forEach(m),Q=P(c),q=y(c,"DIV",{style:!0});var T=V(q);R=y(T,"LABEL",{for:!0,"data-svelte-h":!0}),ee(R)!=="svelte-19vcb14"&&(R.textContent=x),O=P(T),W=y(T,"INPUT",{id:!0,type:!0}),T.forEach(m),c.forEach(m),j=P(b),K=y(b,"LABEL",{});var J=V(K);X=y(J,"INPUT",{type:!0}),$=se(J," SSL"),J.forEach(m),this.h()},h(){v(t,"for","host"),v(r,"id","host"),v(r,"placeholder","localhost"),v(i,"for","port"),v(o,"id","port"),te(a,"flex","1"),v(B,"for","database"),v(k,"id","database"),v(k,"placeholder","postgres"),te(_,"flex","1"),v(f,"class","row svelte-d7xtyc"),v(I,"for","username"),v(H,"id","username"),te(D,"flex","1"),v(R,"for","passwordManual"),v(W,"id","passwordManual"),v(W,"type","password"),te(q,"flex","1"),v(N,"class","row svelte-d7xtyc"),v(X,"type","checkbox")},m(b,w){A(b,t,w),A(b,u,w),A(b,r,w),F(r,s[4]),A(b,h,w),A(b,f,w),p(f,a),p(a,i),p(a,n),p(a,o),F(o,s[5]),p(f,d),p(f,_),p(_,B),p(_,S),p(_,k),F(k,s[6]),A(b,M,w),A(b,N,w),p(N,D),p(D,I),p(D,Z),p(D,H),F(H,s[7]),p(N,Q),p(N,q),p(q,R),p(q,O),p(q,W),F(W,s[8]),A(b,j,w),A(b,K,w),p(K,X),X.checked=s[10],p(K,$),oe||(le=[Y(r,"input",s[28]),Y(o,"input",s[29]),Y(k,"input",s[30]),Y(H,"input",s[31]),Y(W,"input",s[32]),Y(X,"change",s[33])],oe=!0)},p(b,w){w[0]&16&&r.value!==b[4]&&F(r,b[4]),w[0]&32&&o.value!==b[5]&&F(o,b[5]),w[0]&64&&k.value!==b[6]&&F(k,b[6]),w[0]&128&&H.value!==b[7]&&F(H,b[7]),w[0]&256&&W.value!==b[8]&&F(W,b[8]),w[0]&1024&&(X.checked=b[10])},d(b){b&&(m(t),m(u),m(r),m(h),m(f),m(M),m(N),m(j),m(K)),oe=!1,ve(le)}}}function Qe(s){let t,e="Connection string",u,r,h,f,a="Password (connection string mode)",i,l,n,o;return{c(){t=E("label"),t.textContent=e,u=U(),r=E("textarea"),h=U(),f=E("label"),f.textContent=a,i=U(),l=E("input"),this.h()},l(d){t=y(d,"LABEL",{for:!0,"data-svelte-h":!0}),ee(t)!=="svelte-14rvt5g"&&(t.textContent=e),u=P(d),r=y(d,"TEXTAREA",{id:!0,rows:!0,placeholder:!0}),V(r).forEach(m),h=P(d),f=y(d,"LABEL",{for:!0,"data-svelte-h":!0}),ee(f)!=="svelte-1cflhfn"&&(f.textContent=a),i=P(d),l=y(d,"INPUT",{id:!0,type:!0}),this.h()},h(){v(t,"for","connStr"),v(r,"id","connStr"),v(r,"rows",3),v(r,"placeholder","postgres://user:password@host:5432/db?sslmode=require"),v(f,"for","password"),v(l,"id","password"),v(l,"type","password")},m(d,_){A(d,t,_),A(d,u,_),A(d,r,_),F(r,s[2]),A(d,h,_),A(d,f,_),A(d,i,_),A(d,l,_),F(l,s[3]),n||(o=[Y(r,"input",s[26]),Y(l,"input",s[27])],n=!0)},p(d,_){_[0]&4&&F(r,d[2]),_[0]&8&&l.value!==d[3]&&F(l,d[3])},d(d){d&&(m(t),m(u),m(r),m(h),m(f),m(i),m(l)),n=!1,ve(o)}}}function xe(s){let t;return{c(){t=ne("Test Connection")},l(e){t=se(e,"Test Connection")},m(e,u){A(e,t,u)},d(e){e&&m(t)}}}function $e(s){let t;return{c(){t=ne("Save")},l(e){t=se(e,"Save")},m(e,u){A(e,t,u)},d(e){e&&m(t)}}}function et(s){let t;return{c(){t=ne("Cancel")},l(e){t=se(e,"Cancel")},m(e,u){A(e,t,u)},d(e){e&&m(t)}}}function tt(s){let t,e,u="Add Connection",r,h,f,a,i,l="Entry Mode",n,o,d,_,B,z,S,k,M,N,D,I,G,Z,H,Q,q,R,x,O,W,j,K,X,$,oe;h=new Je({props:{label:"Name",hint:"A friendly name for this connection",$$slots:{default:[Ye]},$$scope:{ctx:s}}});function le(g,C){return g[1]==="connectionString"?Qe:Ze}let b=le(s),w=b(s);return R=new _e({props:{variant:"ghost",disabled:!s[9],$$slots:{default:[xe]},$$scope:{ctx:s}}}),R.$on("click",s[14]),O=new _e({props:{variant:"primary",disabled:!s[13],$$slots:{default:[$e]},$$scope:{ctx:s}}}),O.$on("click",s[15]),j=new _e({props:{variant:"link",$$slots:{default:[et]},$$scope:{ctx:s}}}),j.$on("click",s[16]),X=je(s[24][0]),{c(){t=E("div"),e=E("h2"),e.textContent=u,r=U(),me(h.$$.fragment),f=U(),a=E("fieldset"),i=E("legend"),i.textContent=l,n=U(),o=E("div"),d=E("label"),_=E("input"),B=ne(" Connection string"),z=U(),S=E("label"),k=E("input"),M=ne(" Manual fields"),N=U(),w.c(),D=U(),I=E("div"),G=E("span"),Z=ne(s[11]),Q=U(),q=E("div"),me(R.$$.fragment),x=U(),me(O.$$.fragment),W=U(),me(j.$$.fragment),this.h()},l(g){t=y(g,"DIV",{});var C=V(t);e=y(C,"H2",{"data-svelte-h":!0}),ee(e)!=="svelte-8tbe7r"&&(e.textContent=u),r=P(C),de(h.$$.fragment,C),f=P(C),a=y(C,"FIELDSET",{});var c=V(a);i=y(c,"LEGEND",{"data-svelte-h":!0}),ee(i)!=="svelte-1l8tsjr"&&(i.textContent=l),n=P(c),o=y(c,"DIV",{class:!0});var L=V(o);d=y(L,"LABEL",{for:!0});var T=V(d);_=y(T,"INPUT",{id:!0,type:!0}),B=se(T," Connection string"),T.forEach(m),z=P(L),S=y(L,"LABEL",{for:!0});var J=V(S);k=y(J,"INPUT",{id:!0,type:!0}),M=se(J," Manual fields"),J.forEach(m),L.forEach(m),c.forEach(m),N=P(C),w.l(C),D=P(C),I=y(C,"DIV",{class:!0});var ce=V(I);G=y(ce,"SPAN",{class:!0});var ie=V(G);Z=se(ie,s[11]),ie.forEach(m),ce.forEach(m),Q=P(C),q=y(C,"DIV",{style:!0});var re=V(q);de(R.$$.fragment,re),x=P(re),de(O.$$.fragment,re),W=P(re),de(j.$$.fragment,re),re.forEach(m),C.forEach(m),this.h()},h(){v(_,"id","mode-connection"),v(_,"type","radio"),_.__value="connectionString",F(_,_.__value),v(d,"for","mode-connection"),v(k,"id","mode-manual"),v(k,"type","radio"),k.__value="manual",F(k,k.__value),v(S,"for","mode-manual"),v(o,"class","row svelte-d7xtyc"),v(G,"class",H=Ne(s[12]==="error"?"error":s[12]==="success"?"success":"muted")+" svelte-d7xtyc"),v(I,"class","status svelte-d7xtyc"),te(q,"margin-top","12px"),te(q,"display","flex"),te(q,"gap","8px"),X.p(_,k)},m(g,C){A(g,t,C),p(t,e),p(t,r),pe(h,t,null),p(t,f),p(t,a),p(a,i),p(a,n),p(a,o),p(o,d),p(d,_),_.checked=_.__value===s[1],p(d,B),p(o,z),p(o,S),p(S,k),k.checked=k.__value===s[1],p(S,M),p(t,N),w.m(t,null),p(t,D),p(t,I),p(I,G),p(G,Z),p(t,Q),p(t,q),pe(R,q,null),p(q,x),pe(O,q,null),p(q,W),pe(j,q,null),K=!0,$||(oe=[Y(_,"change",s[23]),Y(k,"change",s[25])],$=!0)},p(g,C){const c={};C[0]&1|C[1]&256&&(c.$$scope={dirty:C,ctx:g}),h.$set(c),C[0]&2&&(_.checked=_.__value===g[1]),C[0]&2&&(k.checked=k.__value===g[1]),b===(b=le(g))&&w?w.p(g,C):(w.d(1),w=b(g),w&&(w.c(),w.m(t,D))),(!K||C[0]&2048)&&Ee(Z,g[11]),(!K||C[0]&4096&&H!==(H=Ne(g[12]==="error"?"error":g[12]==="success"?"success":"muted")+" svelte-d7xtyc"))&&v(G,"class",H);const L={};C[0]&512&&(L.disabled=!g[9]),C[1]&256&&(L.$$scope={dirty:C,ctx:g}),R.$set(L);const T={};C[0]&8192&&(T.disabled=!g[13]),C[1]&256&&(T.$$scope={dirty:C,ctx:g}),O.$set(T);const J={};C[1]&256&&(J.$$scope={dirty:C,ctx:g}),j.$set(J)},i(g){K||(ae(h.$$.fragment,g),ae(R.$$.fragment,g),ae(O.$$.fragment,g),ae(j.$$.fragment,g),K=!0)},o(g){ue(h.$$.fragment,g),ue(R.$$.fragment,g),ue(O.$$.fragment,g),ue(j.$$.fragment,g),K=!1},d(g){g&&m(t),fe(h),w.d(),fe(R),fe(O),fe(j),X.r(),$=!1,ve(oe)}}}function st(s){const t=s.trim();if(!t)return null;try{const e=new URL(t),u=e.pathname.replace(/^\//,"");return{host:e.hostname,port:e.port||"5432",database:decodeURIComponent(u),username:decodeURIComponent(e.username||""),password:decodeURIComponent(e.password||""),ssl:e.searchParams.get("sslmode")==="require"}}catch{return null}}function nt(s,t,e){let u,r,h,f,{vscode:a}=t,i="",l="connectionString",n="",o="",d="",_="5432",B="",z="",S="",k=!1,M="",N="",D=!1,I=l;function G(){if(!a)throw new Error("VS Code API unavailable");return a}function Z(){var ke,Se;const c=d.trim(),L=_.trim(),T=B.trim(),J=z.trim();if(!c)return null;const ce=/^postgresql?:\/\//i.test(n)?((Se=(ke=n.match(/^postgresql?:\/\//i))==null?void 0:ke[0])==null?void 0:Se.toLowerCase())??"postgresql://":"postgresql://",ie=J?encodeURIComponent(J):"",re=S?`:${encodeURIComponent(S)}`:"",De=ie?`${ie}${re}@`:"",he=Number(L),Ve=!Number.isNaN(he)&&he>0?`:${he}`:"",Be=c.includes(":")&&!c.startsWith("[")&&!c.endsWith("]")?`[${c}]`:c,Me=T?`/${encodeURIComponent(T)}`:"",Re=k?"?sslmode=require":"";return`${ce.replace(/\/\/$/,"")}//${De}${Be}${Ve}${Me}${Re}`}function H(){return l==="connectionString"?{mode:"connectionString",connStr:n,password:o}:{mode:"manual",host:d,port:_,database:B,username:z,password:S,ssl:k}}async function Q(){e(11,M="Testing..."),e(12,N="info"),e(18,D=!0);try{G().postMessage({command:"testConnection",payload:H()})}catch(c){e(11,M=String(c)),e(12,N="error")}}async function q(){e(11,M="Saving..."),e(12,N="info"),e(18,D=!0);try{const c=H(),L=i.trim();if(!L){e(11,M="Name is required to save"),e(12,N="error"),e(18,D=!1);return}c.name=L,G().postMessage({command:"saveConnection",payload:c})}catch(c){e(11,M=String(c)),e(12,N="error")}}function R(){try{G().postMessage({command:"cancel"})}catch{}}function x(c){const L=c.data;if(!(!L||typeof L!="object")){if(L.command==="testResult"){const T=L.payload;T.success?(e(11,M="Connection OK"),e(12,N="success")):(e(11,M="Failed: "+(T.error||"Unknown error")),e(12,N="error")),e(18,D=!1)}else if(L.command==="saveResult"){const T=L.payload;T.success?(e(11,M="Saved"),e(12,N="success")):(e(11,M="Save failed: "+(T.error||"Unknown error")),e(12,N="error")),e(18,D=!1)}}}Ke(()=>(window.addEventListener("message",x),()=>window.removeEventListener("message",x)));const O=[[]];function W(){i=this.value,e(0,i)}function j(){l=this.__value,e(1,l)}function K(){l=this.__value,e(1,l)}function X(){n=this.value,e(2,n),e(1,l),e(19,I),e(3,o),e(8,S)}function $(){o=this.value,e(3,o),e(1,l),e(19,I),e(2,n),e(8,S)}function oe(){d=this.value,e(4,d),e(1,l),e(19,I),e(2,n),e(3,o),e(8,S)}function le(){_=this.value,e(5,_),e(1,l),e(19,I),e(2,n),e(3,o),e(8,S)}function b(){B=this.value,e(6,B),e(1,l),e(19,I),e(2,n),e(3,o),e(8,S)}function w(){z=this.value,e(7,z),e(1,l),e(19,I),e(2,n),e(3,o),e(8,S)}function g(){S=this.value,e(8,S),e(1,l),e(19,I),e(2,n),e(3,o)}function C(){k=this.checked,e(10,k),e(1,l),e(19,I),e(2,n),e(3,o),e(8,S)}return s.$$set=c=>{"vscode"in c&&e(17,a=c.vscode)},s.$$.update=()=>{if(s.$$.dirty[0]&1&&i.trim().length,s.$$.dirty[0]&524558&&l!==I){if(l==="manual"){const c=st(n);c&&(e(4,d=c.host||""),e(5,_=c.port||"5432"),e(6,B=c.database||""),e(7,z=c.username||""),e(8,S=c.password||""),e(10,k=c.ssl),e(3,o=c.password||o))}else{const c=Z();c&&e(2,n=c),e(3,o=S)}e(19,I=l)}if(s.$$.dirty[0]&6&&l==="connectionString"&&(!n||n.trim().length===0?e(21,u="Connection string is required"):/^(postgres|postgresql):\/\//i.test(n.trim())?e(21,u=""):e(21,u="Connection string should start with postgres:// or postgresql://")),s.$$.dirty[0]&242&&l==="manual"){e(20,r.host=d.trim()?"":"Host is required",r),e(20,r.database=B.trim()?"":"Database is required",r),e(20,r.username=z.trim()?"":"Username is required",r);const c=Number(_);e(20,r.port=!_||Number.isNaN(c)||c<=0||c>65535?"Port must be a number between 1 and 65535":"",r)}s.$$.dirty[0]&3407874&&e(9,h=!D&&(l==="connectionString"&&u===""||l==="manual"&&Object.values(r).every(c=>!c))),s.$$.dirty[0]&513&&e(13,f=h&&i.trim().length>0)},e(21,u=""),e(20,r={host:"",port:"",database:"",username:""}),[i,l,n,o,d,_,B,z,S,h,k,M,N,f,Q,q,R,a,D,I,r,u,W,j,O,K,X,$,oe,le,b,w,g,C]}class ot extends ge{constructor(t){super(),Ce(this,t,nt,tt,ye,{vscode:17},null,[-1,-1])}}const we=document.getElementById("app");if(!we)throw new Error("No root");we.innerHTML="";const rt=window.acquireVsCodeApi?window.acquireVsCodeApi():void 0;new ot({target:we,props:{vscode:rt,initialState:window.initialState}});
